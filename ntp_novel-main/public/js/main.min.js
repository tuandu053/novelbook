function checkAndReplaceImages(){$("img").each(function(){var t=$(this),e=t.attr("src"),a=new Image;a.onload=function(){},a.onerror=function(){$(t).hasClass("ntp_anh_bia")&&$(t).attr("src",$(".ntp_default_img").attr("data_img_novel_df")),$(t).hasClass("ntp_av")&&$(t).attr("src",$(".ntp_default_img").attr("data_img_av_df"))},a.src=e})}function getUrlParameter(){var t=window.location.href,e=t.split("?")[1],a={};if(e)for(var n=e.split("&"),r=0;r<n.length;r++){var o=n[r].split("="),s=decodeURIComponent(o[0]),i=decodeURIComponent(o[1]||"");a[s]=i}return a}function setUrlParameter(t,e){var a=new URL(window.location.href);a.searchParams.set(t,e),window.history.pushState({path:a.toString()},"",a.toString())}function getcookiepermission(){var t=localStorage.getItem("ntp_cookie_permission");return t||(t="no"),t}function askcookiepermission(t,e){var a=localStorage.getItem("ntp_cookie_permission");a&&"yes"!=e||t(".ntp-cookie-ask-btn").trigger("click")}$(document).ready(function(){$("button.phong").on("click",function(){alert("phongllll")});var t='<span class="ntp_alert_close bg-success"><button type="button" class="btn-close"></button></span>',e='<span class="ntp_alert_close bg-danger"><button type="button" class="btn-close"></button></span>',a='<div class="spinner-border spinner-border-sm me-2 text-light" role="status"><span class="visually-hidden">Loading...</span></div>';if($.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".ntp_slick").slick({dots:!0,infinite:!1,speed:300,slidesToShow:6,slidesToScroll:6,infinite:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:4,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:480,settings:{slidesToShow:2,slidesToScroll:2}}]}),$(".ntp_recommend").slick({centerMode:!0,centerPadding:"200px",slidesToShow:1,autoplaySpeed:3e3,responsive:[{breakpoint:768,settings:{centerMode:!0,centerPadding:"50px",slidesToShow:1}},{breakpoint:480,settings:{centerMode:!0,centerPadding:"0px",slidesToShow:1}}]}),$("body").on("click",".ntp_submit_comment",function(){var n=$("#ntp_rating_form")[0],r=new FormData(n),o=$("#ntp_rating_form"),s=$(this);$(s).append(a),$.ajax({method:"POST",url:$(o).attr("action"),contentType:!1,processData:!1,data:r,dataType:"json",success:function(a){if(1==a.status)$(o).find(".alert-danger").fadeOut(200),$(o).find(".alert-success").fadeIn(200).html(a.message+t),$(n)[0].reset(),$(".ntp_novel_rating .rating-start").removeClass("fa-solid").addClass("far"),$("body").trigger("ntp_novel_review");else if(0==a.status){$(o).find(".alert-success").fadeOut(200);var r=a.errors,i="";for(var d in r)i+=r[d]+"</br>";$(o).find(".alert-danger").fadeIn(200).html(i+e)}$(s).find(".spinner-border").remove(),$("body").trigger("ntp-alert-out")},error:function(){$(s).find(".spinner-border").remove()}})}),$("body").on("click",".ntp_comment_reply",function(){var t=$("#ntp_rating_reply_form");$(t).attr("action",$(this).attr("data-link"))}),$("body").on("click",".ntp_comment_update",function(){var t=$("#ntp_update_rating_reply_form"),e=$(this).parents(".comment_item").find("p.comment_content").text().trim();$(t).attr("action",$(this).attr("data-link")),$(t).find('textarea[name="ntp_comment_update"]').text(e)}),$("body").on("click",".ntp_comment_reply_submit",function(){var n=$("#ntp_rating_reply_form")[0],r=new FormData(n),o=$("#ntp_rating_reply_form"),s=$(this);$(s).append(a),$.ajax({method:"POST",url:$(o).attr("action"),contentType:!1,processData:!1,data:r,dataType:"json",success:function(a){if(1==a.status)$(o).find(".alert-danger").fadeOut(200),$(o).find(".alert-success").fadeIn(200).html(a.message+t),$(n)[0].reset(),$(".ntp_novel_rating .rating-start").removeClass("fa-solid").addClass("far"),$("body").trigger("ntp_novel_review"),$(s).parents(".modal").find(".btn-close").trigger("click");else if(0==a.status){$(o).find(".alert-success").fadeOut(200);var r=a.errors,i="";for(var d in r)i+=r[d]+"</br>";$(o).find(".alert-danger").fadeIn(200).html(i+e)}$(s).find(".spinner-border").remove(),$("body").trigger("ntp-alert-out")},error:function(){$(s).find(".spinner-border").remove()}})}),$("body").on("click",".ntp_update_comment_reply_submit",function(){var n=$("#ntp_update_rating_reply_form")[0],r=new FormData(n),o=$("#ntp_update_rating_reply_form"),s=$(this);$(s).append(a),$.ajax({method:"POST",url:$(o).attr("action"),contentType:!1,processData:!1,data:r,dataType:"json",success:function(a){if(1==a.status)$(o).find(".alert-danger").fadeOut(200),$(o).find(".alert-success").fadeIn(200).html(a.message+t),$(n)[0].reset(),$(".ntp_novel_rating .rating-start").removeClass("fa-solid").addClass("far"),$("body").trigger("ntp_novel_review"),$(s).parents(".modal").find(".btn-close").trigger("click");else if(0==a.status){$(o).find(".alert-success").fadeOut(200);var r=a.errors,i="";for(var d in r)i+=r[d]+"</br>";$(o).find(".alert-danger").fadeIn(200).html(i+e)}$(s).find(".spinner-border").remove(),$("body").trigger("ntp-alert-out")},error:function(){$(s).find(".spinner-border").remove()}})}),$("body").on("click",".ntp_novel_rating .rating-start",function(){var t=$(this).data("point"),e=$(".rating_start_input");$(".rating-start").each(function(){$(this).data("point")<=t?$(this).addClass("fa-solid").removeClass("far"):$(this).removeClass("fa-solid").addClass("far")}),$(e).val($(this).data("point"))}),$("body").on("click",".ntp_show_hide_comment,.ntp_delete_comment",function(){var a=$(this).attr("data-link"),n=$(this).attr("data-value"),r=$(this).attr("data-id-comment"),o={value:n,id_comment:r},s="Bạn có chắc muốn thay đổi trạng thái của bình luận này?";if($(this).hasClass("ntp_show_hide_comment"))var s=0==n?"Bạn có chắc muốn ẩn bình luận này?":"Bạn có chắc muốn hiển thị bình luận này?";else var s=0==n?"Bạn có chắc muốn khôi phục bình luận này?":"Bạn có chắc muốn gỡ bình luận này?";var i=confirm(s);i&&$.ajax({method:"POST",url:a,dataType:"json",contentType:"application/json",data:JSON.stringify(o),success:function(a){if(1==a.status)$(".alert-danger.ntp_alert_public").fadeOut(200),$(".alert-success.ntp_alert_public").fadeIn(200).html(a.message+t),$("body").trigger("ntp_novel_review");else if(0==a.status){$(".alert-success.ntp_alert_public").fadeOut(200);var n=a.errors,r="";for(var o in n)r+=n[o]+"</br>";$(".alert-danger.ntp_alert_public").fadeIn(200).html(r+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("ntp_novel_review",function(){var t=$("#ntp_novel_review");if($(t).length){var e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(e){$(t).replaceWith(e.html)},error:function(){}})}}),$("body").on("click",".ntp_btn_report",function(){var n=$("#ntp_form_user_report")[0],r=new FormData(n),o=$("#ntp_form_user_report"),s=$(this);$(s).append(a),$.ajax({method:"POST",url:$(o).attr("action"),contentType:!1,processData:!1,data:r,dataType:"json",success:function(a){if(1==a.status)$(o).find(".alert-danger").fadeOut(200),$(o).find(".alert-success").fadeIn(200).html(a.message+t),$(n)[0].reset();else if(0==a.status){$(o).find(".alert-success").fadeOut(200);var r=a.errors,i="";for(var d in r)i+=r[d]+"</br>";$(o).find(".alert-danger").fadeIn(200).html(i+e)}$(s).find(".spinner-border").remove(),$("body").trigger("ntp-alert-out")},error:function(){$(s).find(".spinner-border").remove()}})}),$("body").on("click",".ntp_report_detail_update",function(){var a=$("#ntp_form_user_report_update");if($(a).length){var n=$("#ntp_form_user_report_update")[0],r=new FormData(n);$.ajax({method:"POST",url:$(a).attr("action"),contentType:!1,processData:!1,data:r,dataType:"json",success:function(n){if(1==n.status)$(a).find(".alert-danger").fadeOut(200),$(a).find(".alert-success").fadeIn(200).html(n.message+t);else if(0==n.status){$(a).find(".alert-success").fadeOut(200);var r=n.errors,o="";for(var s in r)o+=r[s]+"</br>";$(a).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}}),$("body").on("click","#user_report_list-tab",function(){var t=$(this),e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(t){var e=$("#user_report_list");$(e).find(".user_reports").html(t.html)},error:function(){}})}),$("body").on("click",".xu_ly_bao_cao_tab",function(){var t=$(this),e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(e){var a=$(t.attr("data-bs-target"));$(a).html(e.html)},error:function(){}})}),$("body").on("click",".ntp_report_admin_detail_update",function(){var a=$("#ntp_form_admin_report_update");if($(a).length){var n=$("#ntp_form_admin_report_update")[0],r=new FormData(n);$.ajax({method:"POST",url:$(a).attr("action"),contentType:!1,processData:!1,data:r,dataType:"json",success:function(n){if(1==n.status)$(a).find(".alert-danger").fadeOut(200),$(a).find(".alert-success").fadeIn(200).html(n.message+t),$(".xu_ly_bao_cao_tab.active").trigger("click");else if(0==n.status){$(a).find(".alert-success").fadeOut(200);var r=n.errors,o="";for(var s in r)o+=r[s]+"</br>";$(a).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}}),$("body").on("click",".ntp_btn_report_detail_user",function(){var t=$(this),e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(t){var e=$(".ntp_report_detail");$(e).find(".modal-body").html(t.html),$(e).find(".modal-title").html(t.report_title),$(".xu_ly_bao_cao_tab").length<=0&&(0!=t.report_status?$(e).find(".modal-footer").hide():$(e).find(".modal-footer").show())},error:function(){}})}),$("body").on("click",".btn_cancel_withdraw",function(){var a=$(this).attr("data-link"),n="Bạn có chắc muốn hủy yêu cầu này?",r=confirm(n);r&&$.ajax({method:"POST",url:a,dataType:"json",contentType:"application/json",success:function(a){if(1==a.status)$(".alert-danger.ntp_alert_public").fadeOut(200),$(".alert-success.ntp_alert_public").fadeIn(200).html(a.message+t),setTimeout(function(){location.reload()},1e3);else if(0==a.status){$(".alert-success.ntp_alert_public").fadeOut(200);var n=a.errors,r="";for(var o in n)r+=n[o]+"</br>";$(".alert-danger.ntp_alert_public").fadeIn(200).html(r+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_btn_author_withdraw",function(){var n=$(this),r=$("#author_withdraw_form")[0],o=new FormData(r),s=$("#author_withdraw_form");$(n).append(a);$(n).attr("target");$.ajax({method:"POST",url:$(s).attr("action"),contentType:!1,processData:!1,data:o,dataType:"json",success:function(a){if(1==a.status)$(s).find(".alert-danger").fadeOut(200),$(s).find(".alert-success").fadeIn(200).html(a.message+t),setTimeout(function(){location.reload()},1e3);else if(0==a.status){$(s).find(".alert-success").fadeOut(200);var r=a.errors,o="";for(var i in r)o+=r[i]+"</br>";$(s).find(".alert-danger").fadeIn(200).html(o+e)}$(n).find(".spinner-border").remove(),$("body").trigger("ntp-alert-out")},error:function(){$(n).find(".spinner-border").remove()}})}),$("body").on("click",".downloadReport",function(){if(window.pdfBase64&&window.pdfFileName){for(var t=atob(window.pdfBase64),e=[],a=0;a<t.length;a++)e.push(t.charCodeAt(a));var n=new Blob([new Uint8Array(e)],{type:"application/pdf"}),r=document.createElement("a");r.href=window.URL.createObjectURL(n),r.download=window.pdfFileName,r.click()}else alert("Chưa có báo cáo để tải xuống.")}),$("body").on("click",".btn_get_thongke",function(){var n=$(this),r=$($(n).attr("data-form"))[0],o=new FormData(r),s=$($(n).attr("data-form"));$(n).append(a);var i=$(n).attr("target");$(i).find(".downloadReport").addClass("ntp_hidden"),$.ajax({method:"POST",url:$(s).attr("action"),contentType:!1,processData:!1,data:o,dataType:"json",success:function(a){if(1==a.status)$(s).find(".alert-danger").fadeOut(200),$(s).find(".alert-success").fadeIn(200).html(a.message+t),$(i).html(a.html),window.pdfBase64=a.pdfBase64,window.pdfFileName=a.pdfFileName,$(".downloadReport").removeClass("ntp_hidden");else if(0==a.status){$(s).find(".alert-success").fadeOut(200);var r=a.errors,o="";for(var d in r)o+=r[d]+"</br>";$(s).find(".alert-danger").fadeIn(200).html(o+e)}$(n).find(".spinner-border").remove(),$("body").trigger("ntp-alert-out")},error:function(){$(n).find(".spinner-border").remove()}})}),$("button.ntp_btn_cat_create").on("click",function(){var a=$(".ntp_cat_create")[0],n=new FormData(a),r=$(".ntp_cat_create");$.ajax({method:"POST",url:$(a).attr("action"),contentType:!1,processData:!1,data:n,dataType:"json",success:function(a){if(1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_cat_edit",function(){var t=$(this),e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(t){var e=$(".ntp_edit_cat_ppoup");$(e).find(".modal-body").html(t)},error:function(){}})}),$("body").on("click",".ntp_edit_cat_ppoup .ntp_btn_update_cat",function(){var a=$(this),n=$(a).parents(".ntp_edit_cat_ppoup"),r=$(n).find(".modal-body form"),o=$(r).attr("action"),s=$(n).find(".modal-body form")[0],i=new FormData(s);$.ajax({method:"POST",url:o,data:i,contentType:!1,processData:!1,success:function(a){if($("body").trigger("ntp_admin_load_cat_list"),1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("#danh_sach_theloai-tab").on("click",function(){$("body").trigger("ntp_admin_load_cat_list")}),$("body").on("ntp_admin_load_cat_list",function(){var t=$("#danh_sach_theloai-tab");if($(t).length){var e=$(t).attr("data-link");$.ajax({method:"get",url:e,success:function(t){var e=$("#danh_sach_theloai");$(e).html(t)},error:function(){}})}}).trigger("ntp_admin_load_cat_list"),$("#ntp_login_form .ntp_submit_login").on("click",function(){var a=$(this),n=$(a).parents("#ntp_login_register_modal"),r=$(n).find("#ntp_login_form"),o=$(r).attr("action"),s=$(n).find("#ntp_login_form")[0],i=new FormData(s);$.ajax({method:"POST",url:o,data:i,Accept:"application/json",contentType:!1,processData:!1,dataType:"json",success:function(a){if(1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t),setTimeout(function(){location.reload()},400);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("#ntp_register_form .ntp_submit_register").on("click",function(){var a=$(this),n=$(a).parents("#ntp_login_register_modal"),r=$(n).find("#ntp_register_form"),o=$(r).attr("action"),s=$(n).find("#ntp_register_form")[0],i=new FormData(s);$.ajax({method:"POST",url:o,data:i,contentType:!1,processData:!1,dataType:"json",success:function(a){if(console.log(a),1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t),setTimeout(function(){location.reload()},2e3);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$(".ntp_btn_update_infor_user").on("click",function(a){var n=$(this),r=$(n).parents("#ntp_form_update_infor_user"),o=$(n).parents("#ntp_form_update_infor_user")[0],s=new FormData(o),i=$(r).attr("action");$.ajax({method:"POST",url:i,data:s,contentType:!1,processData:!1,dataType:"json",success:function(a){if(console.log(a),1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}}),a.preventDefault()}),$("body").on("change","#ntp_input_update_anhdaidien",function(){var a=$(this)[0],n=a.files[0];if(n){var r=new FileReader;r.onload=function(t){$(".ntp_av_wrap .ntp_av ").attr("src",t.target.result)},r.readAsDataURL(n);var o=$(this),s=($(o).parents("#ntp_form_update_av_user"),$(o).parents("#ntp_form_update_av_user")[0]),i=new FormData(s),d=$(o).attr("data-link");$.ajax({method:"POST",url:d,data:i,contentType:!1,processData:!1,dataType:"json",success:function(a){if(1==a.status)if(1==a.av_update.avatar_change_status){$(".ntp_av_wrap").find(".alert-danger").fadeOut(200),$(".ntp_av_wrap").find(".alert-success").fadeIn(200).html(a.av_update.avatar_change+t);var n=$(".ntp_av");$(n).each(function(){$(this).attr("src",a.av_update.av_link)})}else 0==a.av_update.avatar_change_status&&($(".ntp_av_wrap").find(".alert-success").fadeOut(200),$(".ntp_av_wrap").find(".alert-danger").fadeIn(200).html(a.av_update.avatar_change+e));else{var r=a.errors,o="";for(var s in r)o+=r[s]+"</br>";console.log(a.errors),$(".ntp_av_wrap").find(".alert-success").fadeOut(200),$(".ntp_av_wrap").find(".alert-danger").fadeIn(200).html(o)}$("body").trigger("ntp-alert-out")},error:function(){}})}}),$("body").on("change","#ntp_input_anhbiatruyen",function(){var t=$(this)[0],e=t.files[0];if(e){var a=new FileReader;a.onload=function(t){$(".ntp_anh_bia_wrap .ntp_anh_bia ").attr("src",t.target.result)},a.readAsDataURL(e)}}),$(".ntp_btn_create_author").on("click",function(a){var n=$(this),r=$(n).parents("#ntp_form_create_author"),o=$(n).parents("#ntp_form_create_author")[0],s=new FormData(o),i=$(r).attr("action");$.ajax({method:"POST",url:i,data:s,contentType:!1,processData:!1,dataType:"json",success:function(a){if(console.log(a),1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}a.file&&$(r).find("#ntp_camket_da_upload").attr("src",a.file),$("body").trigger("ntp-alert-out")},error:function(){}}),a.preventDefault()}),$("body").on("click",".ntp_btn_author_detail",function(){var t=$(this),e=$(t).attr("data-link");$.ajax({method:"POST",url:e,success:function(t){var e=$("#ntp_author_detail");$(e).find(".modal-body").html(t)},error:function(){}})}),$("body").on("click",".ntp_author_detail_update",function(){var a=$(this),n=$(a).parents("#ntp_author_detail"),r=$(n).find(".modal-body form"),o=$(r).attr("data-link"),s=$(n).find(".modal-body form")[0],i=new FormData(s);$.ajax({method:"POST",url:o,data:i,contentType:!1,processData:!1,success:function(a){if($("body").trigger("ntp_admin_load_xetduyet_author_list"),$("body").trigger("ntp_admin_load_author_list"),1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t),setTimeout(function(){$(n).find(".btn-close").trigger("click")},1e3);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var o=a.errors,s="";for(var i in o)s+=o[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(s+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_btn_update_chapter",function(){var a=$(this),n=$(a).parents("form#ntp_form_update_chapter"),r=$(n).attr("action"),o=$(a).parents("form#ntp_form_update_chapter")[0],s=new FormData(o);$.ajax({method:"POST",url:r,data:s,contentType:!1,processData:!1,success:function(a){if(1==a.status)$(n).find(".alert-danger").fadeOut(200),$(n).find(".alert-success").fadeIn(200).html(a.message+t);else if(0==a.status){$(n).find(".alert-success").fadeOut(200);var r=a.errors,o="";for(var s in r)o+=r[s]+"</br>";$(n).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click","#danh_sach_nguoi_dung-tab",function(){var t=$(this),e=$(t).attr("data-link"),a=$("#danh_sach_nguoi_dung");$.ajax({method:"Get",url:e,success:function(t){$(a).html(t)},error:function(){$(a).html('<div class="alert alert-danger" role="alert">Có lỗi xảy ra</div>')}})}),$("body").on("change",".admin_user_role_sl",function(){var e=$(this).val(),a=$(this).attr("data-link"),n={admin_user_role:e};$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify(n),success:function(e){if(1==e.status)$(".alert-danger").fadeOut(200),$("#ntp_admin_user_list_wrap").find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){var a=e.errors,n="";for(var r in a)n+=a[r]+"</br>";$(".alert-success").fadeOut(200),$("#ntp_admin_user_list_wrap").find(".alert-danger").fadeIn(200).html(e.message+t)}},error:function(t,e,a){console.log("Error:",a)}}),setTimeout(function(){$(".alert-success").fadeOut(200),$(".alert-danger ").fadeOut(200)},2e3)}),$("body").on("change","input.admin_user_status, input.admin_user_comment",function(){var e=$(this).is(":checked")?1:0,a=$(this).attr("data-link"),n={admin_user_status:e};$(this).hasClass("admin_user_comment")&&(n={admin_user_comment:e}),$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify(n),success:function(e){if(1==e.status)$(".alert-danger").fadeOut(200),$("#ntp_admin_user_list_wrap").find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){var a=e.errors,n="";for(var r in a)n+=a[r]+"</br>";$(".alert-success").fadeOut(200),$("#ntp_admin_user_list_wrap").find(".alert-danger").fadeIn(200).html(e.message+t)}},error:function(t,e,a){console.log("Error:",a)}}),setTimeout(function(){$(".alert-success").fadeOut(200),$(".alert-danger ").fadeOut(200)},2e3)}),$("body").on("click","#xet_duyet_tacgia-tab",function(){$("body").trigger("ntp_admin_load_xetduyet_author_list")}),$("body").on("ntp_admin_load_xetduyet_author_list",function(){var t=$("#xet_duyet_tacgia-tab"),e=$("#xet_duyet_tacgia");if($(t).length){var a=$(t).attr("data-link");$.ajax({method:"Get",url:a,success:function(t){$(e).html(t)},error:function(){$(e).html('<div class="alert alert-danger" role="alert">Có lỗi xảy ra</div>')}})}}).trigger("ntp_admin_load_xetduyet_author_list"),$("body").on("click",".ntp_chitiettruyen",function(){var t=$(this),e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(t){var e=$("#ntp_edit_novel_poup ");$(e).find(".modal-body").html(t)},error:function(){}})}),$("body").on("click",".ntp_admin_btn_update_novel",function(){var a=$(this),n=$(a).parents("#ntp_edit_novel_poup"),r=$(n).find("#ntp_form_novel_License"),o=$(r).attr("action"),s=$(n).find(".modal-body form")[0],i=new FormData(s);$.ajax({method:"POST",url:o,data:i,contentType:!1,processData:!1,success:function(a){if($("body").trigger("ntp_admin_load_xetduyet_novel_list"),1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t),setTimeout(function(){$(n).find(".btn-close").trigger("click")},1e3);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var o=a.errors,s="";for(var i in o)s+=o[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(s+e)}$("body").trigger("ntp-alert-out")},error:function(){}}),$("body").trigger("ntp_admin_load_novel_list")}),$("#xet_duyet_tacpham-tab").click(function(){$("body").trigger("ntp_admin_load_xetduyet_novel_list")}),$("body").on("ntp_admin_load_xetduyet_novel_list",function(){var t=$("#xet_duyet_tacpham-tab");if($(t).length){var e=$(t).attr("data-link");$.ajax({method:"Get",url:e,success:function(t){var e=$("#xet_duyet_tacpham");$(e).html(t)},error:function(){}})}}).trigger("ntp_admin_load_xetduyet_novel_list"),$(".ntp_btn_create_novel,.ntp_btn_update_infor_novel").click(function(a){var n=$(this),r=$(n).parents("#ntp_form_create_novel"),o=$(r).attr("action"),s=CKEDITOR.instances.motatruyen.getData(),i=$(n).parents("#ntp_form_create_novel")[0],d=new FormData(i);d.set("motatruyen",s),$.ajax({method:"POST",url:o,data:d,contentType:!1,processData:!1,success:function(a){if(1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t),$("body").trigger("ntp_author_load_novel_list");else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}}),a.preventDefault()}),$(".ntp_btn_create_chapter").click(function(a){var n=$(this),r=$(n).parents("#ntp_form_create_chapter"),o=$(r).attr("action"),s=CKEDITOR.instances.noidungchuong.getData(),i=$(n).parents("#ntp_form_create_chapter")[0],d=new FormData(i);d.set("noidungchuong",s),$.ajax({method:"POST",url:o,data:d,contentType:!1,processData:!1,success:function(a){if(1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var n=a.errors,o="";for(var s in n)o+=n[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+e)}$("body").trigger("ntp-alert-out")},error:function(){}}),a.preventDefault()}),$("#danhsach_truyen-tab").on("click",function(){$("body").trigger("ntp_author_load_novel_list")}),$("body").on("ntp_author_load_novel_list",function(){var t=$("#danhsach_truyen-tab");if($(t).length){var e=$(t).attr("data-link");$.ajax({method:"POST",url:e,success:function(t){var e=$("#ntp_novel_list_wrap");$(e).html(t)},error:function(){}})}}).trigger("ntp_author_load_novel_list"),$("body").on("click",".admin_kiemduyet_chuong",function(){var t=$(this),e=$(t).attr("data-link"),a=$("#ntp_chapter_detail_admin");$(a).find(".ntp_load").html("Loading..."),$.ajax({method:"GET",url:e,success:function(t){var e=t.chapters;for(var n in e)switch(n){case"id":$(a).find("."+n).val(e[n]);break;case"iPublishingStatus":1==e[n]?$(a).find("#xuly_chapter").prop("checked",!0):$(a).find("#xuly_chapter").prop("checked",!1);break;case"iPublishingStatus":1==e[n]?$(a).find("#xuly_chapter").prop("checked",!0):$(a).find("#xuly_chapter").prop("checked",!1);break;case"iStatus":1==e[n]?$(a).find("#trangthai_chapter").prop("checked",!0):$(a).find("#trangthai_chapter").prop("checked",!1);break;case"icharges":1==e[n]?a.find("."+n).html("Có tính phí"):a.find("."+n).html("Không tính phí");break;default:$(a).find("."+n).html(e[n])}},error:function(){}})}),$("body").on("click",".ntp_chapter_page .ntp_pay_chapter",function(){var a=$(this),n=$(".ntp_chapter_page .ntp_content"),r=$(a).attr("data-link"),o=confirm("Bạn có chắc chắn muốn mua chương này");o&&$.ajax({method:"Get",url:r,success:function(r){if(1==r.status)$(a).parents(".card").find(".alert-danger.ntp_alert_content").fadeOut(200),$(a).parents(".card").find(".alert-success.ntp_alert_content").fadeIn(200).html(r.message+t),$(n).html(r.content);else if(0==r.status){$(a).parents(".card").find(".alert-success.ntp_alert_content").fadeOut(200);var o=r.errors,s="";for(var i in o)s+=o[i]+"</br>";$(a).parents(".card").find(".alert-danger.ntp_alert_content").fadeIn(200).html(s+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_chapter_detail_admin_check",function(){var a=$(this),n=$(a).parents(".ntp_chapter_detail_admin"),r=$(n).find("#ntp_form_chapter_check"),o=$(r).attr("action"),s=$(r).find("#xuly_chapter").is(":checked")?1:0,i=$(r).find("#trangthai_chapter").is(":checked")?1:0,d=$(n).find("#idChapter").val(),c=$(a).attr("data-id-novel"),l={xuly:s,trangthai:i,id:d,id_novel:c,_token:$(r).find('input[name="_token"]').val()};$.ajax({method:"POST",url:o,data:JSON.stringify(l),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if(1==a.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(a.message+t),$("body").trigger("ntp_author_load_novel_list"),$("#ntp_mucluc").html(a.table),setTimeout(function(){$(n).find(".btn-close").trigger("click")},1e3);else if(0==a.status){$(r).find(".alert-success").fadeOut(200);var o=a.errors,s="";for(var i in o)s+=o[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(s+e)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("ntp_bookmark_load_locall",function(){if($(".ntp_bookmarks").hasClass("ntp_bookmarks_locall")&&$(".ntp_bookmarks").length){var t=localStorage.getItem("ntp_bookmarks");if(t)if(t=JSON.parse(t),0!==t.length){var e="";$.each(t,function(t,a){e+='<div class="d-flex flex-row my-1 align-items-center justify-content-between"><a href="'+a.link+'" class="title text-truncate text-decoration-none text-reset">'+a.title+'</a><a href="javascript:void(0);" data-id-novel="'+a.id+'" class="btn ntp_bookmark_remove ntp_locall btn-danger mx-2">X</a></div><hr>'}),$(".ntp_bookmarks").html(e)}else $(".ntp_bookmarks").html("")}}).trigger("ntp_bookmark_load_locall"),$("body").on("ntp_history_load_locall",function(){if($(".ntp_read_history").length&&$(".ntp_read_history").hasClass("ntp_read_history_locall")){var t=$(".ntp_read_history"),e=localStorage.getItem("ntp_historys");if(e){var a="";e=JSON.parse(e),0!==e.length&&$.each(e,function(t,e){a+='<div class="d-flex flex-row my-1 align-items-center justify-content-between"><a href="'+e.link_novel+'" class="title text-truncate text-decoration-none text-reset">'+e.novel_name+"<br> "+e.chapter_name+' </a><div class="d-flex flex-row align-items-center"><a href="'+e.link+'" title="Đọc tiếp" class="btn btn-success mx-2">...</a><a href="javascript:void(0);"  data-id-novel="'+e.id_novel+'" title="Xóa lịch sử" class="btn ntp_remove_readding_history btn-danger me-2">X</a></div></div>'}),$(t).html(a)}}}).trigger("ntp_history_load_locall"),$("body").on("click",".ntp_bookmark_remove",function(a){var n=$(this),r=confirm("Bạn có chắc chắn muốn xoá đánh dấu này");if(r)if($(n).hasClass("ntp_locall")){var o=localStorage.getItem("ntp_bookmarks");if(o){if(o=JSON.parse(o),0!==o.length){var s=null;$.each(o,function(t,e){e.id==parseInt($(n).attr("data-id-novel"))&&(s=t)}),o.splice(s,1)}"yes"==getcookiepermission()&&localStorage.setItem("ntp_bookmarks",JSON.stringify(o)),$("body").trigger("ntp_bookmark_load_locall")}}else{var i=$(n).attr("data-link");$.ajax({method:"Get",url:i,success:function(a){if(1==a.status)$(".alert-danger.ntp_alert_public").fadeOut(200),$(".alert-success.ntp_alert_public").fadeIn(200).html(a.message+t),$(n).parents(".ntp_bookmarks_card").replaceWith(a.bookmarks);else if(0==a.status){var r=a.errors,o="";for(var s in r)o+=r[s]+"</br>";$(".alert-danger.ntp_alert_public").fadeIn(200).html(o+e)}},error:function(){}})}a.preventDefault()}),$("body").on("click",".ntp_remove_readding_history",function(a){var n=$(this),r=confirm("Bạn có chắc chắn muốn xóa lịch sử đọc này");if(r)if($(n).parents(".ntp_read_history").hasClass("ntp_read_history_locall")){var o=$(this).attr("data-id-novel"),s=localStorage.getItem("ntp_historys"),i=null;s&&(s=JSON.parse(s),0!==s.length&&($.each(s,function(t,e){e.id_novel==o&&(i=t)}),null!=i&&(s.splice(i,1),"yes"==getcookiepermission()&&localStorage.setItem("ntp_historys",JSON.stringify(s)),$("body").trigger("ntp_history_load_locall"))))}else{var d=$(n).attr("data-link");$.ajax({method:"get",url:d,success:function(a){if(1==a.status)$(".alert-danger.ntp_alert_public").fadeOut(200),$(".alert-success.ntp_alert_public").fadeIn(200).html(a.message+t),$(n).parents(".ntp_read_history_card").replaceWith(a.history);else if(0==a.status){var r=a.errors,o="";for(var s in r)o+=r[s]+"</br>";$(".alert-danger.ntp_alert_public").fadeIn(200).html(o+e)}},error:function(){}})}a.preventDefault()}),$("body").on("load_user_setting",function(){var t=$("#ntp_form_user_seting"),e="";if(e=$(t).hasClass("ntp_locall_store")?localStorage.getItem("ntp_settings"):$(t).attr("data-setting")){var a=JSON.parse(e);0!==a.length&&($("body").css("font-family",a.ntp_font),$(t).find("#ntp_font_set").val(a.ntp_font),1===a.ntp_mode?($("html").attr("data-bs-theme","dark"),$(t).find("#ntp_dark_mode").prop("checked",!0)):($("html").attr("data-bs-theme","light"),$(t).find("#ntp_dark_mode").prop("checked",!1)))
}}).trigger("load_user_setting"),$("body").on("click",".ntp_user_seting_save",function(){var a=$(this),n=$(a).parents(".modal-content").find("#ntp_form_user_seting"),r=$(n).attr("action"),o=$(n).find("#ntp_font_set").val(),s=$(n).find("#ntp_dark_mode").is(":checked")?1:0,i={ntp_font:o,ntp_mode:s};$(n).hasClass("ntp_locall_store")?("yes"==getcookiepermission()?localStorage.setItem("ntp_settings",JSON.stringify(i)):askcookiepermission($,"yes"),$("body").trigger("load_user_setting"),$(n).find(".alert-success").fadeIn(200).html("Cài đặt của bạn đã được lưu trên trình duyệt bạn nên đăng nhập để lưu trữ tốt hơn"+t)):$.ajax({method:"POST",url:r,data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if(1==a.status)$(n).find(".alert-danger").fadeOut(200),$(n).find(".alert-success").fadeIn(200).html(a.message+t),$(n).attr("data-setting",JSON.stringify(i)),$("body").trigger("load_user_setting");else if(0==a.status){var r=a.errors,o="";for(var s in r)o+=r[s]+"</br>";$(n).find(".alert-danger").fadeIn(200).html(o+e)}},error:function(t){var a="";for(var r in t)a+=errors[r]+"</br>";$(n).find(".alert-danger").fadeIn(200).html(a+e)}}),setTimeout(function(){$(".alert-success:not(.ntp_alert_static)").fadeOut(200),$(".alert-danger:not(.ntp_alert_static)").fadeOut(200)},1e3)}),$("#ntp_login_register_modal").length){if($(".ntp_novel_single").length){var n=localStorage.getItem("ntp_bookmarks"),r=$(".ntp_novel_single").attr("data-novel-id");n&&(n=JSON.parse(n),0!==n.length&&$.each(n,function(t,e){e.id==r&&$(".ntp_novel_single .ntp_mark>p").removeClass("text-success").addClass("text-danger").html('<i class="fa-solid fa-bookmark me-2" aria-hidden="true"></i>Hủy đánh dấu')}))}if($(".ntp_chapter_page").length){var o=localStorage.getItem("ntp_historys"),s=$(".ntp_chapter_title").find(".ntp_novel_name").text(),i=$(".ntp_chapter_title").find(".ntp_chapter_name").text(),d=$(location).attr("href"),c=$(".ntp_chapter_title").attr("data-id-novel"),l=$(".ntp_chapter_title").attr("data-link-novel");o=o?JSON.parse(o):[];var u=!1;0!==o.length&&$.each(o,function(t,e){e.id_novel==c&&(u=!0,e.link=d,e.novel_name=s,e.chapter_name=i,e.link_novel=l)}),u||o.push({novel_name:s,chapter_name:i,id_novel:c,link:d,link_novel:l}),"yes"==getcookiepermission()&&localStorage.setItem("ntp_historys",JSON.stringify(o))}}$("body").on("click",".ntp_mark",function(){var t=$(this),e=$(t).attr("data-novel-id"),a=$(t).attr("data-link"),n=$(t).attr("data-name"),r=$(t).attr("data-novel-link"),o=$(t).find(">p"),s={id_novel:e};$.ajax({method:"POST",url:a,data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if($(o).html(t.message),$(".ntp_count_bookmark").html(t.bookmarks+" đánh dấu"),1==t.status)$(o).removeClass("text-danger").addClass("text-success");else if(0==t.status)$(o).removeClass("text-success").addClass("text-danger");else if(3==t.status){var a=localStorage.getItem("ntp_bookmarks");if("yes"==getcookiepermission()){a=a?JSON.parse(a):[];var s=!1,i=null;0!==a.length&&$.each(a,function(t,a){a.id==e&&(s=!0,i=t)}),s?(a.splice(i,1),$(o).removeClass("text-danger").addClass("text-success").html('<i class="fa-solid fa-bookmark me-2" aria-hidden="true"></i>Đánh dấu')):(a.push({id:e,title:n,link:r}),$(o).removeClass("text-success").addClass("text-danger").html('<i class="fa-solid fa-bookmark me-2" aria-hidden="true"></i>Hủy đánh dấu')),localStorage.setItem("ntp_bookmarks",JSON.stringify(a))}else askcookiepermission($,"yes")}},error:function(){}})}),$("body").on("click",".ntp-show-hide-pass",function(){var t=$(this),e=$(t).parents(".ntp_pass_wrap"),a=$(e).find("input"),n=$(a).attr("type");"password"===n?($(a).attr("type","text"),$(this).addClass("text-danger").removeClass("text-success")):($(a).attr("type","password"),$(this).addClass("text-success").removeClass("text-danger"))}),$("body").on("click",'.dropdown-item[data-bs-toggle="pill"]:not(.ntp_view_child)',function(){if("pill"==$(this).attr("data-bs-toggle")){var t=$(this).attr("id"),e=$(this).attr("data-bs-target");setUrlParameter("view",t),$("html, body").animate({scrollTop:$(e).offset().top-100},200)}}),$("body").on("click",".ntp_alert_close .btn-close,.modal .btn-close",function(){$(".alert:not(.ntp_alert_static)").fadeOut(200)}),$("body").on("ntp-alert-out",function(){setTimeout(function(){$(".alert:not(.ntp_alert_static)").fadeOut(200)},4e3)}),$("body").on("input",".admin_search_tacgia",function(){var t=$(this).val(),e=$(".ntp_drop_down_search_author");if(t.length>=3){var a=$(this).attr("data-link")+"/"+t;$.ajax({method:"POST",url:a,success:function(t){$(e).find(".card-body").html(t.html)},error:function(){}})}else $(e).find(".card-body").html("")}),$("body").on("click",".ntp_item_tacgia",function(){$(".admin_search_tacgia").attr("data-iduser",$(this).attr("data-iduser")),$(".admin_search_tacgia").val($(this).text())}),$("body").on("click",".ntp_home_cat_search_item",function(){$(".ntp_home_cat_search_form .ntp_home_cat_search_form_submit").trigger("click")}),$("body").on("click","#ntp-cookie-ask .modal-footer .btn",function(){var t="";"no"==$(this).attr("data-ask")?t="no":"yes"==$(this).attr("data-ask")&&(t="yes"),localStorage.setItem("ntp_cookie_permission",t)}),askcookiepermission($,"")}),$(window).on("load",function(){queryParams=getUrlParameter($),setTimeout(function(){if(0!=Object.keys(queryParams).length&&"view"in queryParams&&""!=queryParams.view){var t=$("#"+queryParams.view).attr("data-bs-target");$("#"+queryParams.view).trigger("click"),$(t).length&&$("html, body").animate({scrollTop:$(t).offset().top-100},200)}},100),$("#user_report_list-tab").length&&$("#user_report_list-tab").trigger("click"),checkAndReplaceImages()});